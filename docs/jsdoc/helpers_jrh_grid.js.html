<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>helpers/jrh_grid.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="JrResult.JrContext.html">JrContext</a></li><li><a href="JrResult.JrResult.html">JrResult</a></li><li><a href="module-client_arclient-AppRoomClient.html">AppRoomClient</a></li><li><a href="module-controllers_aclaid-AclAid.html">AclAid</a></li><li><a href="module-controllers_adminaid-AdminAid.html">AdminAid</a></li><li><a href="module-controllers_arserver-AppRoomServer.html">AppRoomServer</a><ul class='methods'><li data-type='method'><a href="module-controllers_arserver-AppRoomServer.html#emergencyAlert">emergencyAlert</a></li><li data-type='method'><a href="module-controllers_arserver-AppRoomServer.html#makeSecureTokenAccess">makeSecureTokenAccess</a></li><li data-type='method'><a href="module-controllers_arserver-AppRoomServer.html#makeSecureTokenAccessFromRefreshToken">makeSecureTokenAccessFromRefreshToken</a></li><li data-type='method'><a href="module-controllers_arserver-AppRoomServer.html#makeSecureTokenRefresh">makeSecureTokenRefresh</a></li></ul></li><li><a href="module-controllers_crudaid-CrudAid.html">CrudAid</a></li><li><a href="module-controllers_registrationaid-RegistrationAid.html">RegistrationAid</a></li><li><a href="module-controllers_sendaid-SendAid.html">SendAid</a><ul class='methods'><li data-type='method'><a href="module-controllers_sendaid-SendAid.html#sendMail">sendMail</a></li><li data-type='method'><a href="module-controllers_sendaid-SendAid.html#sendMessage">sendMessage</a></li></ul></li><li><a href="module-controllers_setupaid-SetupAid.html">SetupAid</a></li><li><a href="module-helpers_jrresult-JrResult.html">JrResult</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#._unusedCodeExpressMiddlewareInjectSessionResult">_unusedCodeExpressMiddlewareInjectSessionResult</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.isBlank">isBlank</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.isJrResult">isJrResult</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeClone">makeClone</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeError">makeError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeMessage">makeMessage</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeNew">makeNew</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeSuccess">makeSuccess</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.passportOrJrResultErrorAsString">passportOrJrResultErrorAsString</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.retrieveThenRemoveFromSession">retrieveThenRemoveFromSession</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.undefinedIfBlank">undefinedIfBlank</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#addToSession">addToSession</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#clear">clear</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#clearSection">clearSection</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#copyFrom">copyFrom</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getErrorsAsString">getErrorsAsString</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getExtraData">getExtraData</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getFieldError">getFieldError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getSuccessAsString">getSuccessAsString</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getType">getType</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#isError">isError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#mergeIn">mergeIn</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#mergeInThenRemoveFromSession">mergeInThenRemoveFromSession</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#push">push</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushBiFieldError">pushBiFieldError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushError">pushError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushErrorOnTop">pushErrorOnTop</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushException">pushException</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushFieldError">pushFieldError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushMessage">pushMessage</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushSuccess">pushSuccess</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#setError">setError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#setExtraData">setExtraData</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#setFieldError">setFieldError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#setType">setType</a></li></ul></li><li><a href="module-models_app-AppModel.html">AppModel</a></li><li><a href="module-models_connection-ConnectionModel.html">ConnectionModel</a></li><li><a href="module-models_file-FileModel.html">FileModel</a></li><li><a href="module-models_login-LoginModel.html">LoginModel</a></li><li><a href="module-models_log-LogModel.html">LogModel</a></li><li><a href="module-models_model_base_mongoose_minimal-ModelBaseMongooseMinimal.html">ModelBaseMongooseMinimal</a></li><li><a href="module-models_modelBaseMongoose-ModelBaseMongoose.html">ModelBaseMongoose</a><ul class='methods'><li data-type='method'><a href="module-models_modelBaseMongoose-ModelBaseMongoose.html#.doChangeModeById">doChangeModeById</a></li><li data-type='method'><a href="module-models_modelBaseMongoose-ModelBaseMongoose.html#doChangeMode">doChangeMode</a></li></ul></li><li><a href="module-models_modqueue-ModQueueModel.html">ModQueueModel</a></li><li><a href="module-models_option-OptionModel.html">OptionModel</a></li><li><a href="module-models_option-RoleModel.html">RoleModel</a></li><li><a href="module-models_roomdata-RoomdataModel.html">RoomdataModel</a></li><li><a href="module-models_room-RoomModel.html">RoomModel</a></li><li><a href="module-models_session-SessionModel.html">SessionModel</a></li><li><a href="module-models_subscription-SubscriptionModel.html">SubscriptionModel</a></li><li><a href="module-models_user-UserModel.html">UserModel</a><ul class='methods'><li data-type='method'><a href="module-models_user-UserModel.html#aclHasPermission">aclHasPermission</a></li><li data-type='method'><a href="module-models_user-UserModel.html#aclHasPermissionOnAll">aclHasPermissionOnAll</a></li><li data-type='method'><a href="module-models_user-UserModel.html#aclHasPermissionSeeVDeletes">aclHasPermissionSeeVDeletes</a></li></ul></li><li><a href="module-models_verification-VerificationModel.html">VerificationModel</a></li></ul><h3>Modules</h3><ul><li><a href="module-arglobals.html">arglobals</a><ul class='methods'><li data-type='method'><a href="module-arglobals.html#~setupDefaultModulePaths">setupDefaultModulePaths</a></li></ul></li><li><a href="module-client_arclient.html">client/arclient</a><ul class='methods'><li data-type='method'><a href="module-client_arclient.html#~makeNewAppRoomClient">makeNewAppRoomClient</a></li></ul></li><li><a href="module-clientTests.html">clientTests</a></li><li><a href="module-controllers_aclaid.html">controllers/aclaid</a></li><li><a href="module-controllers_adminaid.html">controllers/adminaid</a></li><li><a href="module-controllers_appdef.html">controllers/appdef</a></li><li><a href="module-controllers_arserver.html">controllers/arserver</a></li><li><a href="module-controllers_crudaid.html">controllers/crudaid</a></li><li><a href="module-controllers_jrequireaid.html">controllers/jrequireaid</a><ul class='methods'><li data-type='method'><a href="module-controllers_jrequireaid.html#~setDeferredLoading">setDeferredLoading</a></li><li data-type='method'><a href="module-controllers_jrequireaid.html#~setupDefaultModulePaths">setupDefaultModulePaths</a></li></ul></li><li><a href="module-controllers_registrationaid.html">controllers/registrationaid</a></li><li><a href="module-controllers_sendaid.html">controllers/sendaid</a></li><li><a href="module-controllers_setupaid.html">controllers/setupaid</a></li><li><a href="module-helpers_jrconfig.html">helpers/jrconfig</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrconfig.html#~addConfigFile">addConfigFile</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~addConfigFilesCli">addConfigFilesCli</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~configAutoConverTypeVal">configAutoConverTypeVal</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~discoverConfigFiles">discoverConfigFiles</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~doNconfFile">doNconfFile</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~findQueuedCommand">findQueuedCommand</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~fixConfigFilePathName">fixConfigFilePathName</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~getDebugFiles">getDebugFiles</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~getDebugHierarchy">getDebugHierarchy</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~getDebugOptions">getDebugOptions</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~getVal">getVal</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~getValDefault">getValDefault</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~ipStringToSafeFilenameString">ipStringToSafeFilenameString</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~nconfMergeConfigFile">nconfMergeConfigFile</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~parse">parse</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~popQueuedCommand">popQueuedCommand</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~queueYargsCommand">queueYargsCommand</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~runQueuedCommands">runQueuedCommands</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setConfigDirs">setConfigDirs</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setDefaultOptions">setDefaultOptions</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setEnvList">setEnvList</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setOverrideOptions">setOverrideOptions</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setServerFilenamePrefixFromServerIp">setServerFilenamePrefixFromServerIp</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setYargs">setYargs</a></li></ul></li><li><a href="module-helpers_jrcontext.html">helpers/jrcontext</a></li><li><a href="module-helpers_jrdebug.html">helpers/jrdebug</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrdebug.html#~cdebug">cdebug</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~cdebugf">cdebugf</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~cdebugObj">cdebugObj</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~debug">debug</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~debugf">debugf</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~debugObj">debugObj</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~debugObj2">debugObj2</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~getDebugTagEnabled">getDebugTagEnabled</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~setDebugTagEnabled">setDebugTagEnabled</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~setup">setup</a></li><li data-type='method'><a href="module-helpers_jrdebug.html#~setupDebugmod">setupDebugmod</a></li></ul></li><li><a href="module-helpers_jrequire.html">helpers/jrequire</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrequire.html#~calcDebugInfo">calcDebugInfo</a></li><li data-type='method'><a href="module-helpers_jrequire.html#~fixRequirePath">fixRequirePath</a></li><li data-type='method'><a href="module-helpers_jrequire.html#~jrequire">jrequire</a></li><li data-type='method'><a href="module-helpers_jrequire.html#~registerPath">registerPath</a></li><li data-type='method'><a href="module-helpers_jrequire.html#~registerRequire">registerRequire</a></li><li data-type='method'><a href="module-helpers_jrequire.html#~setDeferredLoading">setDeferredLoading</a></li></ul></li><li><a href="module-helpers_jrh_axios.html">helpers/jrh_axios</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_axios.html#~calcAxiosOptions">calcAxiosOptions</a></li><li data-type='method'><a href="module-helpers_jrh_axios.html#~getCatchError">getCatchError</a></li><li data-type='method'><a href="module-helpers_jrh_axios.html#~postAxiosGetResponseDataCatchError">postAxiosGetResponseDataCatchError</a></li></ul></li><li><a href="module-helpers_jrh_crypto.html">helpers/jrh_crypto</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_crypto.html#~createHashedObjectFromString">createHashedObjectFromString</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~generateRandomSalt">generateRandomSalt</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~genRandomStringFromCharSet">genRandomStringFromCharSet</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~genRandomStringHex">genRandomStringHex</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~genRandomStringHumanEasier">genRandomStringHumanEasier</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~genRandomStringHumanEasy">genRandomStringHumanEasy</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~hashPlaintextPasswordToObj">hashPlaintextPasswordToObj</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~hashPlaintextStringInsecureButSearchable">hashPlaintextStringInsecureButSearchable</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~testPlaintextPassword">testPlaintextPassword</a></li></ul></li><li><a href="module-helpers_jrh_express.html">helpers/jrh_express</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_express.html#~asyncPassportAuthenticate">asyncPassportAuthenticate</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~asyncPassportReqLogin">asyncPassportReqLogin</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressMiddleWare">calcExpressMiddleWare</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressMiddlewareGetFileLine">calcExpressMiddlewareGetFileLine</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressMiddlewareRouterHint">calcExpressMiddlewareRouterHint</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressRoutePathData">calcExpressRoutePathData</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressRoutePathDataRouteArray">calcExpressRoutePathDataRouteArray</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressRoutePathDataSplit">calcExpressRoutePathDataSplit</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~forgetSessionVar">forgetSessionVar</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~normalizePort">normalizePort</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~parseReqGetJsonField">parseReqGetJsonField</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqOriginalUrl">reqOriginalUrl</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqPrefixedCheckboxItemIds">reqPrefixedCheckboxItemIds</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqPrefixedValueArray">reqPrefixedValueArray</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqUrlWithPath">reqUrlWithPath</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqVal">reqVal</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqValAsInt">reqValAsInt</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqValFromList">reqValFromList</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~sendJsonDataSuccess">sendJsonDataSuccess</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~sendJsonErorrAcl">sendJsonErorrAcl</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~sendJsonError">sendJsonError</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~sendJsonErrorAuthToken">sendJsonErrorAuthToken</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~sendJsonResult">sendJsonResult</a></li></ul></li><li><a href="module-helpers_jrh_grid.html">helpers/jrh_grid</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_grid.html#~calcHeaderKeysNicely">calcHeaderKeysNicely</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridList">jrGridList</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListBulkActions">jrGridListBulkActions</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListPager">jrGridListPager</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListPagerItem">jrGridListPagerItem</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListPagerItemPerPage">jrGridListPagerItemPerPage</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListShowHiddenOptions">jrGridListShowHiddenOptions</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListTable">jrGridListTable</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListTableData">jrGridListTableData</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListTableHeader">jrGridListTableHeader</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListTableHeaderSortDir">jrGridListTableHeaderSortDir</a></li></ul></li><li><a href="module-helpers_jrh_handlebars.html">helpers/jrh_handlebars</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_handlebars.html#~loadPartialFiles">loadPartialFiles</a></li><li data-type='method'><a href="module-helpers_jrh_handlebars.html#~setupJrHandlebarHelpers">setupJrHandlebarHelpers</a></li></ul></li><li><a href="module-helpers_jrh_misc.html">helpers/jrh_misc</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_misc.html#~asyncAwaitForEachFunctionCall">asyncAwaitForEachFunctionCall</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~asyncAwaitForEachObjectKeyFunctionCall">asyncAwaitForEachObjectKeyFunctionCall</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~asyncNextTick">asyncNextTick</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~copyMissingValues">copyMissingValues</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~createObjectFromJsonParse">createObjectFromJsonParse</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~DateNowPlusMinutes">DateNowPlusMinutes</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~deepIterationCopy">deepIterationCopy</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~ErrorToHashableMapObject">ErrorToHashableMapObject</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~findLongestPrefixAndRemainder">findLongestPrefixAndRemainder</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~firstCoercedTrueValue">firstCoercedTrueValue</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getCompactNowString">getCompactNowString</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getNiceDateValString">getNiceDateValString</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getNiceDurationTimeMs">getNiceDurationTimeMs</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getNiceNowString">getNiceNowString</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getNonFalseValueOrDefault">getNonFalseValueOrDefault</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getNonNullValueFromObject">getNonNullValueFromObject</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getNonNullValueOrDefault">getNonNullValueOrDefault</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getPreciseNowString">getPreciseNowString</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getServerIpAddress">getServerIpAddress</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~isInAnyArray">isInAnyArray</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~isObjectEmpty">isObjectEmpty</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~isObjectHashMappableType">isObjectHashMappableType</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~isPromise">isPromise</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~isSimpleObject">isSimpleObject</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~makeSafeForFormInput">makeSafeForFormInput</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~mergeArraysDedupe">mergeArraysDedupe</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~mergeArraysKeepDupes">mergeArraysKeepDupes</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~objectHasProperty">objectHasProperty</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~objToString">objToString</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~objToString2">objToString2</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~regexEscapeStr">regexEscapeStr</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~resolvePossiblyRelativeDirectory">resolvePossiblyRelativeDirectory</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~shallowCopy">shallowCopy</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~stringArrayToNiceString">stringArrayToNiceString</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~usleep">usleep</a></li></ul></li><li><a href="module-helpers_jrh_mongo.html">helpers/jrh_mongo</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_mongo.html#~calcDatabaseInfo">calcDatabaseInfo</a></li><li data-type='method'><a href="module-helpers_jrh_mongo.html#~calcDatabaseStructure">calcDatabaseStructure</a></li><li data-type='method'><a href="module-helpers_jrh_mongo.html#~convertArrayOfObjectIdsToIdArray">convertArrayOfObjectIdsToIdArray</a></li><li data-type='method'><a href="module-helpers_jrh_mongo.html#~isValidMongooseObjectId">isValidMongooseObjectId</a></li><li data-type='method'><a href="module-helpers_jrh_mongo.html#~OldUnusedMongoIdEqual">OldUnusedMongoIdEqual</a></li></ul></li><li><a href="module-helpers_jrh_mongo_filter.html">helpers/jrh_mongo_filter</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~buildMongooseQueryFromReq">buildMongooseQueryFromReq</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilter">convertReqQueryStringToAMongooseFindFilter</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterBoolean">convertReqQueryStringToAMongooseFindFilterBoolean</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterGenericOperator">convertReqQueryStringToAMongooseFindFilterGenericOperator</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterGenericOperatorResolveVal">convertReqQueryStringToAMongooseFindFilterGenericOperatorResolveVal</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterMongoStrCmp">convertReqQueryStringToAMongooseFindFilterMongoStrCmp</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterNumeric">convertReqQueryStringToAMongooseFindFilterNumeric</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterStringic">convertReqQueryStringToAMongooseFindFilterStringic</a></li></ul></li><li><a href="module-helpers_jrh_ratelimiter.html">helpers/jrh_ratelimiter</a></li><li><a href="module-helpers_jrh_text.html">helpers/jrh_text</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_text.html#~capitalizeFirstLetter">capitalizeFirstLetter</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrBootstrapCollapseBox">jrBootstrapCollapseBox</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlFormInputPassword">jrHtmlFormInputPassword</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlFormOptionList">jrHtmlFormOptionList</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlFormOptionListSelect">jrHtmlFormOptionListSelect</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlNiceOptionFromList">jrHtmlNiceOptionFromList</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlStrigifyObject">jrHtmlStrigifyObject</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrPluralize">jrPluralize</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrPluralizeCount">jrPluralizeCount</a></li></ul></li><li><a href="module-helpers_jrh_validate.html">helpers/jrh_validate</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateInteger">validateInteger</a></li><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateIntegerRange">validateIntegerRange</a></li><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateJsonObjOrStringToObj">validateJsonObjOrStringToObj</a></li><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateRealName">validateRealName</a></li><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateString">validateString</a></li><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateTrueFalse">validateTrueFalse</a></li></ul></li><li><a href="module-helpers_jrlog.html">helpers/jrlog</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrlog.html#~aliasWinstonLogger">aliasWinstonLogger</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~calcLogFilePath">calcLogFilePath</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~createLogFileObj">createLogFileObj</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~createWinstonLoggerObject">createWinstonLoggerObject</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~getWinstonCategoryLogger">getWinstonCategoryLogger</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~log">log</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~logDefaultError">logDefaultError</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~logExceptionError">logExceptionError</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~logExceptionErrorWithMessage">logExceptionErrorWithMessage</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~logMessage">logMessage</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~logObject">logObject</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~setup">setup</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~setupMorganMiddlewareForExpressWebAccessLogging">setupMorganMiddlewareForExpressWebAccessLogging</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~setupWinstonLogger">setupWinstonLogger</a></li></ul></li><li><a href="module-helpers_jrresult.html">helpers/jrresult</a></li><li><a href="module-models_app.html">models/app</a></li><li><a href="module-models_connection.html">models/connection</a></li><li><a href="module-models_file.html">models/file</a></li><li><a href="module-models_log.html">models/log</a></li><li><a href="module-models_login.html">models/login</a></li><li><a href="module-models_model_base_mongoose_minimal.html">models/model_base_mongoose_minimal</a></li><li><a href="module-models_modelBaseMongoose.html">models/modelBaseMongoose</a></li><li><a href="module-models_modqueue.html">models/modqueue</a></li><li><a href="module-models_option.html">models/option</a></li><li></li><li><a href="module-models_room.html">models/room</a></li><li><a href="module-models_roomdata.html">models/roomdata</a></li><li><a href="module-models_session.html">models/session</a></li><li><a href="module-models_subscription.html">models/subscription</a></li><li><a href="module-models_user.html">models/user</a></li><li><a href="module-models_verification.html">models/verification</a></li><li><a href="module-plugins_testplugin.html">plugins/testplugin</a></li><li></li><li></li><li><a href="module-routes_admin.html">routes/admin</a></li><li></li><li></li><li><a href="module-routes_analytics.html">routes/analytics</a></li><li><a href="module-routes_api_api.html">routes/api/api</a><ul class='methods'><li data-type='method'><a href="module-routes_api_api.html#~routerAllDos">routerAllDos</a></li><li data-type='method'><a href="module-routes_api_api.html#~routerAllHello">routerAllHello</a></li><li data-type='method'><a href="module-routes_api_api.html#~routerAllRefreshAccess">routerAllRefreshAccess</a></li><li data-type='method'><a href="module-routes_api_api.html#~routerAllReqRefreshSession">routerAllReqRefreshSession</a></li><li data-type='method'><a href="module-routes_api_api.html#~routerAllTokenTest">routerAllTokenTest</a></li><li data-type='method'><a href="module-routes_api_api.html#~routerGetIndex">routerGetIndex</a></li><li data-type='method'><a href="module-routes_api_api.html#~routerGetReqRefreshCredentials">routerGetReqRefreshCredentials</a></li><li data-type='method'><a href="module-routes_api_api.html#~routerPostReqRefreshCredentials">routerPostReqRefreshCredentials</a></li><li data-type='method'><a href="module-routes_api_api.html#~setupRouter">setupRouter</a></li></ul></li><li><a href="module-routes_api_app.html">routes/api/app</a><ul class='methods'><li data-type='method'><a href="module-routes_api_app.html#~setupRouter">setupRouter</a></li></ul></li><li><a href="module-routes_api_roomdata.html">routes/api/roomdata</a><ul class='methods'><li data-type='method'><a href="module-routes_api_roomdata.html#~setupRouter">setupRouter</a></li><li data-type='method'><a href="module-routes_api_roomdata.html#~setupRouter">setupRouter</a></li></ul></li><li></li><li><a href="module-routes_app.html">routes/app</a></li><li></li><li><a href="module-routes_index.html">routes/index</a></li><li><a href="module-routes_login.html">routes/login</a></li><li><a href="module-routes_logout.html">routes/logout</a></li><li><a href="module-routes_membersonly.html">routes/membersonly</a></li><li><a href="module-routes_profile.html">routes/profile</a></li><li><a href="module-routes_register.html">routes/register</a></li><li><a href="module-routes_room.html">routes/room</a></li><li><a href="module-routes_verify.html">routes/verify</a></li><li><a href="module-serverTests.html">serverTests</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">helpers/jrh_grid.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module helpers/jrh_grid
 * @author jesse reichler &lt;mouser@donationcoder.com>
 * @copyright 6/21/19

 * @description
 * Collection of helper functions for creating general purpose html grids of data
*/

"use strict";


// our helper modules
const jrhMisc = require("./jrh_misc");
const jrhText = require("./jrh_text");

const jrequire = require("./jrequire");






/**
 * Builds a grid table/list and form inputs for working with it
 *
 * @param {object} req - express request object
 * @param {obj} listHelperData - data to put in the grid; from model_base_mongoose?
 * @returns raw html string
 */
async function jrGridList(jrContext, listHelperData, csrfToken) {
	//
	let rethtml = "";
	const flagShowDebugInfo = false;
	const flagShowTopPager = false;

	// destructure parts
	const queryUrlData = listHelperData.queryUrlData;
	const tableid = queryUrlData.tableId;


	// form wrapper start
	rethtml += `
		&lt;form id="jrGridList_${tableid}" action="#">
		`;

	// insert data object for the table
	const gridListDataJson = JSON.stringify(queryUrlData);
	// ATTN: 5/18/20 - IMPORTANT -- must use "var jrGridListData_" instead of "let jrGridListData_" or we get js error in browser
	rethtml += `&lt;script>
			var jrGridListData_${tableid} = ${gridListDataJson};
		&lt;/script>
		`;

	const pagerHtml = jrGridListPager(queryUrlData);

	// link to ADD a new item
	const addUrl = queryUrlData.baseUrl + "/add";
	const addLabel = listHelperData.modelClass.getNiceName();
	rethtml += `
			&lt;div class="float-right">&lt;h4>&lt;a href="${addUrl}">Add ${addLabel}&lt;/a>&lt;/h4>&lt;/div>
		`;

	// add pager at top
	if (flagShowTopPager) {
		rethtml += pagerHtml;
	}

	// show result count
	const resultCount = queryUrlData.resultCount;
	rethtml += "&lt;div>&lt;strong>Total items:" + resultCount.toString() + "&lt;/strong>&lt;/div>";

	// build table
	rethtml += await jrGridListTable(jrContext, listHelperData, queryUrlData);

	// show deleted/hidden options
	rethtml += await jrGridListShowHiddenOptions(jrContext, listHelperData, queryUrlData);

	// build "with all checked" input
	rethtml += await jrGridListBulkActions(jrContext, listHelperData, queryUrlData, tableid);

	// add pager at bottom
	rethtml += pagerHtml;

	// debug info
	if (flagShowDebugInfo) {
		rethtml += "&lt;br/>&lt;hr/>";
		const debugHtml = "&lt;pre>listHelperData: " + JSON.stringify(listHelperData, null, "  ") + "&lt;/pre>";
		rethtml += debugHtml;
	}

	// add csrf
	if (csrfToken) {
		rethtml += `
			&lt;input type="hidden" name="_csrf" value="${csrfToken}">
		`;
	}

	// form wrapper start
	rethtml += `
		&lt;/form>
		`;

	if (flagShowDebugInfo) {
		// debug extra stuff
		rethtml += "\n&lt;br/>&lt;hr/>\n" + jrhText.jrBootstrapCollapseBox("Table Debug", listHelperData, "");
	}

	// return it as raw html
	return rethtml;
}
//---------------------------------------------------------------------------


















//---------------------------------------------------------------------------
// private helper functions
/**
 * Build the html that represents the main area of the grid table
 * @private
 * @param {object} req
 * @param {object} listHelperData
 * @param {object} queryUrlData
 * @returns raw html string
 */
async function jrGridListTable(jrContext, listHelperData, queryUrlData) {
	let rethtml = "";

	// beginning stuff
	rethtml += `
		&lt;div class="table-responsive">
			&lt;table class="table table-striped w-auto table-bordered">
		`;

	// header
	rethtml += jrGridListTableHeader(listHelperData, queryUrlData);

	// data
	rethtml += await jrGridListTableData(jrContext, listHelperData, queryUrlData);

	// ending stuff
	rethtml += `
			&lt;/table>
		&lt;/div>
		`;

	return rethtml;
}



/**
 * Builds the core internal html table data
 * @private
 * @param {object} req
 * @param {object} listHelperData
 * @param {object} queryUrlData
 * @returns raw html string
 */
async function jrGridListTableData(jrContext, listHelperData, queryUrlData) {
	let rethtml = "";

	// data body start
	rethtml += `
			&lt;tbody>
		`;

	// data content
	const gridSchema = listHelperData.gridSchema;
	const headerKeys = calcHeaderKeysNicely(gridSchema);
	const gridItems = listHelperData.gridItems;

	//
	const filterOptions = listHelperData.filterOptions;
	const protectedFields = filterOptions.protectedFields;
	const hiddenFields = filterOptions.hiddenFields;

	// cache extra info for each header column
	const extraInfo = {};
	headerKeys.forEach((key) => {
		extraInfo[key] = {
			valformat: listHelperData.modelClass.getSchemaFieldVal(key, "format"),
			valueFunction: listHelperData.modelClass.getSchemaFieldVal(key, "valueFunction"),
			refModelClass: listHelperData.modelClass.getSchemaFieldVal(key, "refModelClass"),
			valchoices: listHelperData.modelClass.getSchemaFieldVal(key, "choices"),
		};
	});

	let val, valtype, valueFunction, valformat, valDisplay, valchoices, refModelClass;
	let extraInfoKey;
	let item;
	let url;
	const numItems = gridItems.length;

	for (let i = 0; i &lt; numItems; i += 1) {
		item = gridItems[i];
		// start
		rethtml += `
				&lt;tr>
				`;

		// item row
		await jrhMisc.asyncAwaitForEachFunctionCall(headerKeys, async (key) => {
			if (jrhMisc.isInAnyArray(key, hiddenFields)) {
				return;
			}

			// SPECIAL COLUMNS
			if (key === "_batch_checkbox") {
				// checkbox for batch actions
				rethtml += `
						&lt;td scope="col"> &lt;input type="checkbox" name="checkboxid_${item._id}"> &lt;/td>
				`;
				return;
			}
			if (key === "_actions") {
				// action column
				rethtml += "&lt;td scope=\"col\">";
				// edit
				const urlEdit = queryUrlData.baseUrl + "/edit/" + item._id;
				rethtml += `&lt;a href="${urlEdit}" title="edit">&amp;#9998;&lt;/a> `;
				// undelete
				if (("disabled" in item) &amp;&amp; item.disabled === 2) {
					const urlUnDelete = queryUrlData.baseUrl + "/undelete/" + item._id;
					rethtml += ` &lt;a href="${urlUnDelete}" title="undelete">&amp;#9852;&lt;/a> `;
				} else {
					// delete
					const urlDelete = queryUrlData.baseUrl + "/delete/" + item._id;
					rethtml += ` &lt;a href="${urlDelete}" title="delete">&amp;#10008;&lt;/a> `;
				}
				rethtml += "&lt;/td>";
				return;
			}


			// ATTN: TODO -- split this off into a standalone function we can reuse elsewhere
			// and perhaps reuse it for crudaid
			// let valHtml = modelClass.renderFieldValueHtml(req, obj, reqbody, fieldName, crudSubType, helperData);

			extraInfoKey = extraInfo[key];

			val = item[key];

			// put value as href link?
			url = undefined;
			// ids are internal special columns we know how to link
			if (key === "_id" &amp;&amp; val) {
				url = queryUrlData.baseUrl + "/view/" + val;
			}

			// set url from schema info
			if (!url &amp;&amp; val) {
				refModelClass = extraInfoKey.refModelClass;
				if (refModelClass) {
					url = refModelClass.getCrudUrlBase("view", val);
				}
			}


			// extra scheme info
			valformat = extraInfoKey.valformat;
			valueFunction = extraInfoKey.valueFunction;
			valchoices = extraInfoKey.valchoices;

			// format it
			if (valueFunction) {
				// use custom value resolving callback function
				valDisplay = await valueFunction(jrContext, "list", key, item, null, listHelperData);
			} else {
				if (valformat === "checkbox") {
					if (val) {
						valDisplay = "true";
					} else {
						valDisplay = "false";
					}
				} else if (valformat === "choices") {
					// choices can be tricky.. because we'd like to show the nice choice option, but we also want to show underlying values so user can filter (esp. if it's numerical)
					valDisplay = jrhText.jrHtmlNiceOptionFromList(valchoices, val);
				} else if (valformat === "textarea") {
					valDisplay = jrhText.sanitizeUnsafeText(val, true, true);
				} else if (valformat === "date") {
					// format as compact date
					valDisplay = jrhText.formatDateNicely(val, true);
				} else {
					// default coerce to string
					valDisplay = jrhText.sanitizeUnsafeText(jrhText.coerceToString(val, true), true, false);
				}
			}

			// wrap in href url?
			if (url) {
				valDisplay = `&lt;a href="${url}">${valDisplay}&lt;/a>`;
			}

			// add cell value
			rethtml += `&lt;td scope="col"> ${valDisplay} &lt;/td>`;
		});

		// end row
		rethtml += `
				&lt;/tr>
				`;
	}

	// data body end
	rethtml += `
			&lt;/tbody>
		`;

	return rethtml;
}
//---------------------------------------------------------------------------







//---------------------------------------------------------------------------
/**
 * Builds html for a with all checked drop down box and button
 *
 * @private
 * @param {object} req
 * @param {object} listHelperData
 * @param {object} queryUrlData
 */
async function jrGridListBulkActions(jrContext, listHelperData, queryUrlData, tableid) {
	let rethtml = "";

	// beginning
	rethtml += "&lt;div>With all checked: ";

	// drop down box of choices
	rethtml += `&lt;select name="bulkaction">
		&lt;option value="">&lt;/option>
	`;


	// enable and disable
	rethtml += `
		&lt;option value="enable">Enable All&lt;/option>
		&lt;option value="disable">Disable All&lt;/option>
	`;

	// virtual delete/undelete
	if (listHelperData.modelClass.supportsVirtualDelete()) {
		rethtml += `
			&lt;option value="delete">Delete All (virtually)&lt;/option>
			&lt;option value="undelete">Un-delete All (virtually)&lt;/option>
		`;
	}

	// permanently delete
	rethtml += `
		&lt;option value="permdelete">Permanently Delete All (!)&lt;/option>

	`;

	// end of choices
	rethtml += "&lt;/select>";

	// go button
	rethtml += "&lt;input name=\"bulkactiongo\" type=\"button\" value =\"GO\" onclick=\"requestGridBulkAction('" + tableid + "'); return false;\">&lt;/input>";

	// end
	rethtml += "&lt;/div>&lt;br/>";
	return rethtml;
}
//---------------------------------------------------------------------------







//---------------------------------------------------------------------------
/**
 * Builds html for implementing a pager area for the grid
 *
 * @private
 * @param {object} queryUrlData
 * @returns raw html string
 */
function jrGridListPager(queryUrlData) {
	// see https://www.tutorialrepublic.com/twitter-bootstrap-tutorial/bootstrap-pagination.php
	let rethtml = "";

	const pageNum = queryUrlData.pageNum;
	const resultCount = queryUrlData.resultCount;
	const pageSize = queryUrlData.pageSize;
	//
	const pageCount = Math.ceil(resultCount / pageSize);
	const pageSurroundCount = 3;
	//
	const pageStart = Math.max(1, pageNum - pageSurroundCount);
	const pageEnd = Math.min(pageCount, pageNum + pageSurroundCount);
	const pageUp = Math.max(1, pageNum - ((pageSurroundCount * 2) + 1));
	const pageDown = Math.min(pageCount, pageNum + ((pageSurroundCount * 2) + 1));
	let flagActive;
	//
	// we want like:  FIRST | PREVIOUS | ... | 4 | 5 | 6 | 7 | 8 | ... | NEXT | LAST

	rethtml += `
		&lt;nav>
			&lt;ul class="pagination">
			`;

	// build the items before current pages
	rethtml += jrGridListPagerItem("First", 1, (pageNum !== 1), false, queryUrlData);
	rethtml += jrGridListPagerItem("Previous", pageNum - 1, (pageNum > 1), false, queryUrlData);
	rethtml += jrGridListPagerItem("...", pageUp, (pageUp &lt; pageNum), false, queryUrlData);
	// surrounding numbers around current page
	for (let i = pageStart; i &lt;= pageEnd; i += 1) {
		if (i === pageNum) {
			flagActive = true;
		} else {
			flagActive = false;
		}
		rethtml += jrGridListPagerItem(i.toString(), i, true, flagActive, queryUrlData);
	}
	// after current pages
	rethtml += jrGridListPagerItem("...", pageDown, (pageDown > pageNum), false, queryUrlData);
	rethtml += jrGridListPagerItem("Next", pageNum + 1, (pageNum &lt; pageCount), false, queryUrlData);
	rethtml += jrGridListPagerItem("Last (" + pageCount + ")", pageCount, (pageNum &lt; pageCount), false, queryUrlData);

	rethtml += `
		&lt;/ul>
		&lt;/nav>
		`;

	// page size selector
	rethtml += `
		&lt;nav>
			&lt;ul class="pagination">
		`;
	//
	rethtml += jrGridListPagerItemPerPage("Items per page", 0, pageSize, false, queryUrlData);
	rethtml += jrGridListPagerItemPerPage(null, 10, pageSize, true, queryUrlData);
	rethtml += jrGridListPagerItemPerPage(null, 50, pageSize, true, queryUrlData);
	rethtml += jrGridListPagerItemPerPage(null, 100, pageSize, true, queryUrlData);
	rethtml += jrGridListPagerItemPerPage(null, 250, pageSize, true, queryUrlData);
	rethtml += jrGridListPagerItemPerPage(null, 500, pageSize, true, queryUrlData);
	rethtml += jrGridListPagerItemPerPage(null, 1000, pageSize, true, queryUrlData);
	//
	rethtml += `
			&lt;/ul>
			&lt;/nav>
		`;

	// return it
	return rethtml;
}

/**
 * Builds a single pager item.
 *
 * @private
 * @param {string} label
 * @param {int} pageIndex - current page
 * @param {boolean} flagLink - whether pager item should be a working link
 * @param {boolean} flagActive - whether this pager item represents current page
 * @param {object} queryUrlData
 * @returns raw html string
 */
function jrGridListPagerItem(label, pageIndex, flagLink, flagActive, queryUrlData) {
	// make an item for pager
	let liclass = "";
	if (flagActive) {
		liclass += " active";
	}
	if (!flagLink) {
		liclass += " disabled";
	}
	const url = "#";
	const updateObjString = "{pageNum: '" + pageIndex.toString() + "'}";
	const onclick = "requestGridUpdate('" + queryUrlData.tableId + "', " + updateObjString + ", false);return false;";

	const rethtml = `
		&lt;li class="page-item${liclass}">
			&lt;a href="${url}" onclick="${onclick}" class="page-link">${label}&lt;/a>
		&lt;/li>
		`;

	return rethtml;
}


/**
 * Helper function that creates the per-page dropdown option select
 *
 * @private
 * @param {string} label
 * @param {int} newPageSize - the new page size that this item selects
 * @param {int} currentPageSize - the current page size of the currently viewed page
 * @param {boolean} flagLink - whether to link it
 * @param {object} queryUrlData
 * @returns raw html string
 */
function jrGridListPagerItemPerPage(label, newPageSize, currentPageSize, flagLink, queryUrlData) {
	// make an item for pager page size control
	if (label === null) {
		label = newPageSize.toString();
	}
	const flagActive = (newPageSize === currentPageSize);
	let liclass = "";
	if (flagActive) {
		liclass += " active";
	}
	if (!flagLink) {
		liclass += " disabled";
	}

	const url = "#"; // queryUrlData.baseUrl + "?pageSize=" + newPageSize.toString();
	const updateObjString = "{pageSize: '" + newPageSize.toString() + "'}";
	const onclick = "requestGridUpdate('" + queryUrlData.tableId + "', " + updateObjString + ", true);return false;";

	const rethtml = `
		&lt;li class="page-item${liclass}">
			&lt;a href="${url}" onclick="${onclick}" class="page-link">${label}&lt;/a>
		&lt;/li>
		`;

	return rethtml;
}


/**
 * Generates the header for a table with sortable columns, and filters
 * @private
 * @param {object} listHelperData
 * @param {object} queryUrlData
 * @returns raw html string
 */
function jrGridListTableHeader(listHelperData, queryUrlData) {
	// defaults
	const defaultFilterInputSize = 20;
	const flagUseLabel = true;

	// header start
	let rethtml = "";
	rethtml += `
			&lt;thead>
		`;

	// main header content
	rethtml += `
				&lt;tr>
		`;

	// data content
	const gridSchema = listHelperData.gridSchema;
	const headerKeys = calcHeaderKeysNicely(gridSchema);
	const filterOptions = listHelperData.filterOptions;
	const protectedFields = filterOptions.protectedFields;
	const hiddenFields = filterOptions.hiddenFields;

	let onclick;
	headerKeys.forEach((key) => {
		if (jrhMisc.isInAnyArray(key, hiddenFields)) {
			return;
		}
		//
		if (key === "_batch_checkbox") {
			// toggle check all button
			onclick = "jrGridToggleCheckboxes('" + queryUrlData.tableId + "');return false;";
			rethtml += `
					&lt;th scope="col"> &lt;input type="checkbox" name="_batch_checkbox_all" onclick="${onclick}" title="toggle all checkboxes"> &lt;/th>
				`;
		} else if (key === "_actions") {
			// actions column for edit/delete buttons
			rethtml += `
					&lt;th scope="col"> &amp;nbsp; &lt;/th>
				`;
		} else if (false &amp;&amp; jrhMisc.isInAnyArray(key, protectedFields)) {
			rethtml += `
					&lt;th scope="col">${key}&lt;/th>
				`;
		} else {
			const sortDir = jrGridListTableHeaderSortDir(key, queryUrlData);
			let extraLabel = "";
			let updateObjString;
			let title;
			let keyLabel;
			if (sortDir) {
				if (sortDir === "asc") {
					extraLabel = " &amp;#9650;";
					updateObjString = "{sortDir: 'desc'}";
				} else {
					extraLabel = " &amp;#9660;";
					updateObjString = "{sortDir: 'asc'}";
				}
				title = "change sort direction";
			} else {
				updateObjString = "{sortField:'" + key + "', sortDir: 'asc'}";
				title = "sort on this variable";
			}
			onclick = "requestGridUpdate('" + queryUrlData.tableId + "', " + updateObjString + ", true);return false;";
			//
			// use label?
			if (flagUseLabel) {
				keyLabel = listHelperData.modelClass.getSchemaFieldVal(key, "label", key);
			} else {
				if (key === "_id") {
					// fixup for id
					keyLabel = "id";
				} else {
					keyLabel = key;
				}
			}
			rethtml += `
					&lt;th scope="col"> &lt;a href="#" onclick="${onclick}" title="${title}"> ${keyLabel}${extraLabel} &lt;/a>&lt;/th>
				`;
		}
	});
	//
	rethtml += `
				&lt;/tr>
		`;

	// filter row
	rethtml += `
				&lt;tr>
		`;
	headerKeys.forEach((key) => {
		if (jrhMisc.isInAnyArray(key, hiddenFields)) {
			return;
		}
		if (key === "_batch_checkbox") {
			onclick = "jrGridClearFilters('" + queryUrlData.tableId + "'); requestGridUpdate('" + queryUrlData.tableId + "', {}, true); return false;";
			rethtml += `
					&lt;th scope="col"> &lt;a href="#" onclick="${onclick}" title="clear all filters"> &amp;#x2717; &lt;/a> &lt;/th>
				`;
		} else if (key === "_actions") {
			// action column
			rethtml += `
					&lt;th scope="col"> &amp;nbsp; &lt;/th>
				`;
		} else if (jrhMisc.isInAnyArray(key, protectedFields)) {
			rethtml += `
					&lt;th scope="col">&amp;nbsp;&lt;/th>
				`;
		} else {
			let val = queryUrlData.fieldFilters[key];
			if (val === undefined) {
				val = "";
			} else {
				val = jrhMisc.makeSafeForFormInput(val);
			}
			const onkeydown = "jrGridGenericOnEnterRefresh(event, '" + queryUrlData.tableId + "', this, true)";
			const size = listHelperData.modelClass.getSchemaFieldVal(key, "filterSize", defaultFilterInputSize);
			if (!size) {
				rethtml += `
						&lt;th scope="col"> &amp;nbsp; &lt;/th>
					`;
			} else {
				rethtml += `
						&lt;th scope="col"> &lt;input type="text" name="filter_${key}" value="${val}" size="${size}" onkeydown="${onkeydown}" title="type search filter and hit Enter to refresh"> &lt;/th>
					`;
			}
		}
	});
	//
	rethtml += `
				&lt;/tr>
		`;

	// header end
	rethtml += `
			&lt;/thead>
		`;

	return rethtml;
}

/**
 * Returns the sort direction of a column key, based on previously parsed data
 * @private
 * @param {*} key
 * @param {*} queryUrlData
 * @returns string sort direction (asc|desc|null)
 */
function jrGridListTableHeaderSortDir(key, queryUrlData) {
	if (queryUrlData.sortField === key) {
		return queryUrlData.sortDir;
	}
	return null;
}



/**
 * Get keys (columnns) for the header, adding our special ones for checkbox column and actions icons column
 * @private
 * @param {object} gridSchema
 * @returns raw html string
 */
function calcHeaderKeysNicely(gridSchema) {
	const headerKeys = Object.keys(gridSchema);

	// add checkbox
	headerKeys.unshift("_batch_checkbox");

	// add column for actions at end
	headerKeys.push("_actions");

	// return it
	return headerKeys;
}
//---------------------------------------------------------------------------







/**
 *  Add some hidden optinon to the grid form
 *
 * @param {*} req
 * @param {*} listHelperData
 * @param {*} queryUrlData
 * @returns html to add to the input form
 */
function jrGridListShowHiddenOptions(jrContext, listHelperData, queryUrlData) {
	// show a drop down with hidden options
	// what we show may depend on user acl permissions
	const tableid = queryUrlData.tableId;
	const appdef = jrequire("appdef");

	let rethtml = "";

	if (false) {
		// start stuff
		rethtml += "&lt;hr/>&lt;div>";
		// build form input
		const selectedid = "all";
		rethtml += "Show: " + jrhText.jrHtmlFormOptionListSelect("showdisabled", appdef.DefShowStateModeLabels, selectedid, false);
	}

	// end stuff
	rethtml += "&lt;/div>&lt;hr/>";

	return rethtml;
}
//---------------------------------------------------------------------------

















// export the class as the sole export
module.exports = {
	jrGridList,
};
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Sun Jun 21 2020 11:32:01 GMT-0500 (Central Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
