<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>helpers/jrresult.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="JrResult.JrResult.html">JrResult</a></li><li><a href="module-controllers_aclaid-AclAid.html">AclAid</a></li><li><a href="module-controllers_adminaid-AdminAid.html">AdminAid</a></li><li><a href="module-controllers_arserver-AppRoomServer.html">AppRoomServer</a></li><li><a href="module-controllers_crudaid-CrudAid.html">CrudAid</a></li><li><a href="module-controllers_ratelimiteraid-RateLimiterAid.html">RateLimiterAid</a></li><li><a href="module-controllers_registrationaid-RegistrationAid.html">RegistrationAid</a></li><li><a href="module-helpers_jrresult-JrResult.html">JrResult</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#._unusedCodeExpressMiddlewareInjectSessionResult">_unusedCodeExpressMiddlewareInjectSessionResult</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.getMergeSessionResultAndClear">getMergeSessionResultAndClear</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.isBlank">isBlank</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.isJrResult">isJrResult</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeAndRemoveFromSession">makeAndRemoveFromSession</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeClone">makeClone</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeError">makeError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeMessage">makeMessage</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeNew">makeNew</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.makeSuccess">makeSuccess</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.passportOrJrResultErrorAsString">passportOrJrResultErrorAsString</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#.undefinedIfBlank">undefinedIfBlank</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#addToSession">addToSession</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#clear">clear</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#clearSection">clearSection</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#copyFrom">copyFrom</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getDoneRendering">getDoneRendering</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getErrorsAsString">getErrorsAsString</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getExtraData">getExtraData</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getFieldError">getFieldError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#getType">getType</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#isError">isError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#mergeIn">mergeIn</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#push">push</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushBiFieldError">pushBiFieldError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushError">pushError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushErrorOnTop">pushErrorOnTop</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushFieldError">pushFieldError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushMessage">pushMessage</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#pushSuccess">pushSuccess</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#setDoneRendering">setDoneRendering</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#setError">setError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#setExtraData">setExtraData</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#setFieldError">setFieldError</a></li><li data-type='method'><a href="module-helpers_jrresult-JrResult.html#setType">setType</a></li></ul></li><li><a href="module-models_app-AppModel.html">AppModel</a></li><li><a href="module-models_connection-ConnectionModel.html">ConnectionModel</a></li><li><a href="module-models_file-FileModel.html">FileModel</a></li><li><a href="module-models_login-LoginModel.html">LoginModel</a></li><li><a href="module-models_log-LogModel.html">LogModel</a></li><li><a href="module-models_model_base_mongoose_minimal-ModelBaseMongooseMinimal.html">ModelBaseMongooseMinimal</a></li><li><a href="module-models_modelBaseMongoose-ModelBaseMongoose.html">ModelBaseMongoose</a></li><li><a href="module-models_option-OptionModel.html">OptionModel</a></li><li><a href="module-models_roomdata-RoomdataModel.html">RoomdataModel</a></li><li><a href="module-models_room-RoomModel.html">RoomModel</a></li><li><a href="module-models_session-SessionModel.html">SessionModel</a></li><li><a href="module-models_user-UserModel.html">UserModel</a></li><li><a href="module-models_verification-VerificationModel.html">VerificationModel</a></li></ul><h3>Modules</h3><ul><li><a href="module-controllers_aclaid.html">controllers/aclaid</a></li><li><a href="module-controllers_adminaid.html">controllers/adminaid</a></li><li><a href="module-controllers_arserver.html">controllers/arserver</a></li><li><a href="module-controllers_crudaid.html">controllers/crudaid</a></li><li><a href="module-controllers_ratelimiteraid.html">controllers/ratelimiteraid</a></li><li><a href="module-controllers_registrationaid.html">controllers/registrationaid</a></li><li><a href="module-helpers_jrconfig.html">helpers/jrconfig</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrconfig.html#~addConfigFile">addConfigFile</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~findQueuedCommand">findQueuedCommand</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~fixConfigFilePathName">fixConfigFilePathName</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~getDebugObj">getDebugObj</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~getVal">getVal</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~getValDefault">getValDefault</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~ipStringToSafeFilenameString">ipStringToSafeFilenameString</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~nconfMergeCliConfigFiles">nconfMergeCliConfigFiles</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~nconfMergeConfigFile">nconfMergeConfigFile</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~parse">parse</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~popQueuedCommand">popQueuedCommand</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~queueYargsCommand">queueYargsCommand</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~runQueuedCommands">runQueuedCommands</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setConfigDirAndDiscoverFiles">setConfigDirAndDiscoverFiles</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setDefaultOptions">setDefaultOptions</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setEnvList">setEnvList</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setOverrideOptions">setOverrideOptions</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setServerFilenamePrefixFromServerIp">setServerFilenamePrefixFromServerIp</a></li><li data-type='method'><a href="module-helpers_jrconfig.html#~setYargs">setYargs</a></li></ul></li><li><a href="module-helpers_jrh_crypto.html">helpers/jrh_crypto</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_crypto.html#~createHashedObjectFromString">createHashedObjectFromString</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~generateRandomSalt">generateRandomSalt</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~genRandomStringHex">genRandomStringHex</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~genRandomStringHumanEasier">genRandomStringHumanEasier</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~genRandomStringHumanEasy">genRandomStringHumanEasy</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~hashPlaintextPasswordToObj">hashPlaintextPasswordToObj</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~hashPlaintextStringInsecureButSearchable">hashPlaintextStringInsecureButSearchable</a></li><li data-type='method'><a href="module-helpers_jrh_crypto.html#~testPlaintextPassword">testPlaintextPassword</a></li></ul></li><li><a href="module-helpers_jrh_express.html">helpers/jrh_express</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_express.html#~asyncPasswordAuthenticate">asyncPasswordAuthenticate</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~asyncPasswordReqLogin">asyncPasswordReqLogin</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressMiddleWare">calcExpressMiddleWare</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressRoutePathData">calcExpressRoutePathData</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressRoutePathDataRouteArray">calcExpressRoutePathDataRouteArray</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~calcExpressRoutePathDataSplit">calcExpressRoutePathDataSplit</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~forgetSessionVar">forgetSessionVar</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~normalizePort">normalizePort</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqPrefixedValueArray">reqPrefixedValueArray</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqVal">reqVal</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqValAsInt">reqValAsInt</a></li><li data-type='method'><a href="module-helpers_jrh_express.html#~reqValFromList">reqValFromList</a></li></ul></li><li><a href="module-helpers_jrh_grid.html">helpers/jrh_grid</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_grid.html#~calcHeaderKeysNicely">calcHeaderKeysNicely</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridList">jrGridList</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListPager">jrGridListPager</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListPagerItem">jrGridListPagerItem</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListPagerItemPerPage">jrGridListPagerItemPerPage</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListTable">jrGridListTable</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListTableData">jrGridListTableData</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListTableHeader">jrGridListTableHeader</a></li><li data-type='method'><a href="module-helpers_jrh_grid.html#~jrGridListTableHeaderSortDir">jrGridListTableHeaderSortDir</a></li></ul></li><li><a href="module-helpers_jrh_handlebars.html">helpers/jrh_handlebars</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_handlebars.html#~loadPartialFiles">loadPartialFiles</a></li><li data-type='method'><a href="module-helpers_jrh_handlebars.html#~setupJrHandlebarHelpers">setupJrHandlebarHelpers</a></li></ul></li><li><a href="module-helpers_jrh_misc.html">helpers/jrh_misc</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_misc.html#~asyncAwaitForEachFunctionCall">asyncAwaitForEachFunctionCall</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~createObjectFromJsonParse">createObjectFromJsonParse</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~DateNowPlusMinutes">DateNowPlusMinutes</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~deepIterationCopy">deepIterationCopy</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~firstCoercedTrueValue">firstCoercedTrueValue</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getNiceNowString">getNiceNowString</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getNonFalseValueOrDefault">getNonFalseValueOrDefault</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getNonNullValueOrDefault">getNonNullValueOrDefault</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getPreciseNowString">getPreciseNowString</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~getServerIpAddress">getServerIpAddress</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~isInAnyArray">isInAnyArray</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~isObjectEmpty">isObjectEmpty</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~isPromise">isPromise</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~isSimpleObject">isSimpleObject</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~makeSafeForFormInput">makeSafeForFormInput</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~mergeArraysDedupe">mergeArraysDedupe</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~mergeArraysKeepDupes">mergeArraysKeepDupes</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~regexEscapeStr">regexEscapeStr</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~shallowCopy">shallowCopy</a></li><li data-type='method'><a href="module-helpers_jrh_misc.html#~stringArrayToNiceString">stringArrayToNiceString</a></li></ul></li><li><a href="module-helpers_jrh_mongo.html">helpers/jrh_mongo</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_mongo.html#~calcDatabaseResourceUse">calcDatabaseResourceUse</a></li><li data-type='method'><a href="module-helpers_jrh_mongo.html#~calcDatabaseStructure">calcDatabaseStructure</a></li><li data-type='method'><a href="module-helpers_jrh_mongo.html#~isValidMongooseObjectId">isValidMongooseObjectId</a></li><li data-type='method'><a href="module-helpers_jrh_mongo.html#~mongoIdEqual">mongoIdEqual</a></li></ul></li><li><a href="module-helpers_jrh_mongo_filter.html">helpers/jrh_mongo_filter</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~buildMongooseQueryFromReq">buildMongooseQueryFromReq</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilter">convertReqQueryStringToAMongooseFindFilter</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterBoolean">convertReqQueryStringToAMongooseFindFilterBoolean</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterGenericOperator">convertReqQueryStringToAMongooseFindFilterGenericOperator</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterGenericOperatorResolveVal">convertReqQueryStringToAMongooseFindFilterGenericOperatorResolveVal</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterMongoStrCmp">convertReqQueryStringToAMongooseFindFilterMongoStrCmp</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterNumeric">convertReqQueryStringToAMongooseFindFilterNumeric</a></li><li data-type='method'><a href="module-helpers_jrh_mongo_filter.html#~convertReqQueryStringToAMongooseFindFilterStringic">convertReqQueryStringToAMongooseFindFilterStringic</a></li></ul></li><li><a href="module-helpers_jrh_text.html">helpers/jrh_text</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_text.html#~jrBootstrapCollapseBox">jrBootstrapCollapseBox</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlFormInputPassword">jrHtmlFormInputPassword</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlFormOptionList">jrHtmlFormOptionList</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlFormOptionListSelect">jrHtmlFormOptionListSelect</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlNiceOptionFromList">jrHtmlNiceOptionFromList</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrHtmlStrigifyObject">jrHtmlStrigifyObject</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrPluralize">jrPluralize</a></li><li data-type='method'><a href="module-helpers_jrh_text.html#~jrPluralizeCount">jrPluralizeCount</a></li></ul></li><li><a href="module-helpers_jrh_validate.html">helpers/jrh_validate</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateInteger">validateInteger</a></li><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateIntegerRange">validateIntegerRange</a></li><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateRealName">validateRealName</a></li><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateString">validateString</a></li><li data-type='method'><a href="module-helpers_jrh_validate.html#~validateTrueFalse">validateTrueFalse</a></li></ul></li><li><a href="module-helpers_jrlog.html">helpers/jrlog</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrlog.html#~calcLogFilePath">calcLogFilePath</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~cdebug">cdebug</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~cdebugf">cdebugf</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~cdebugObj">cdebugObj</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~convertErrorTypeToWinstonLevel">convertErrorTypeToWinstonLevel</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~debug">debug</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~debugf">debugf</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~debugObj">debugObj</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~error">error</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~getDebugEnabled">getDebugEnabled</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~info">info</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~log">log</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~logStdDbMessage">logStdDbMessage</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~objToString">objToString</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~setDebugEnabled">setDebugEnabled</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~setup">setup</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~setupDebugmod">setupDebugmod</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~setupMorganMiddlewareForExpressWebAccessLogging">setupMorganMiddlewareForExpressWebAccessLogging</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~setupWinston">setupWinston</a></li><li data-type='method'><a href="module-helpers_jrlog.html#~warning">warning</a></li></ul></li><li><a href="module-helpers_jrresult.html">helpers/jrresult</a></li><li><a href="module-models_app.html">models/app</a></li><li><a href="module-models_connection.html">models/connection</a></li><li><a href="module-models_file.html">models/file</a></li><li><a href="module-models_log.html">models/log</a></li><li><a href="module-models_login.html">models/login</a></li><li><a href="module-models_model_base_mongoose_minimal.html">models/model_base_mongoose_minimal</a></li><li><a href="module-models_modelBaseMongoose.html">models/modelBaseMongoose</a></li><li><a href="module-models_option.html">models/option</a></li><li><a href="module-models_room.html">models/room</a></li><li><a href="module-models_roomdata.html">models/roomdata</a></li><li><a href="module-models_session.html">models/session</a></li><li><a href="module-models_user.html">models/user</a></li><li><a href="module-models_verification.html">models/verification</a></li><li><a href="module-routes_admin.html">routes/admin</a></li><li><a href="module-routes_analytics.html">routes/analytics</a></li><li><a href="module-routes_api.html">routes/api</a><ul class='methods'><li data-type='method'><a href="module-routes_api.html#~makeSecureTokenAccess">makeSecureTokenAccess</a></li><li data-type='method'><a href="module-routes_api.html#~makeSecureTokenAccessFromRefreshToken">makeSecureTokenAccessFromRefreshToken</a></li><li data-type='method'><a href="module-routes_api.html#~makeSecureTokenRefresh">makeSecureTokenRefresh</a></li><li data-type='method'><a href="module-routes_api.html#~routerAllTokentest">routerAllTokentest</a></li><li data-type='method'><a href="module-routes_api.html#~routerGetIndex">routerGetIndex</a></li><li data-type='method'><a href="module-routes_api.html#~routerGetRefreshaccess">routerGetRefreshaccess</a></li><li data-type='method'><a href="module-routes_api.html#~routerGetReqrefresh">routerGetReqrefresh</a></li><li data-type='method'><a href="module-routes_api.html#~routerGetWildcard">routerGetWildcard</a></li><li data-type='method'><a href="module-routes_api.html#~routerPostReqrefresh">routerPostReqrefresh</a></li><li data-type='method'><a href="module-routes_api.html#~setupRouter">setupRouter</a></li></ul></li><li><a href="module-routes_app.html">routes/app</a></li><li></li><li><a href="module-routes_index.html">routes/index</a></li><li><a href="module-routes_login.html">routes/login</a></li><li><a href="module-routes_logout.html">routes/logout</a></li><li><a href="module-routes_membersonly.html">routes/membersonly</a></li><li><a href="module-routes_profile.html">routes/profile</a></li><li><a href="module-routes_register.html">routes/register</a></li><li><a href="module-routes_room.html">routes/room</a></li><li><a href="module-routes_verify.html">routes/verify</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">helpers/jrresult.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module helpers/jrresult
 * @author jesse reichler &lt;mouser@donationcoder.com>
 * @copyright 5/24/19

 * @description
 * Error helper class
*/

"use strict";


// modules
const assert = require("assert");

// helper modules
const jrhMisc = require("./jrh_misc");






//---------------------------------------------------------------------------
// JrResult is a class for returning an error from functions with enough information that it can be displayed to the user
// with helper methods for logging, etc.
/**
 * We use JrResult object instances to store the results of operations, where we may want to indicate a success or an error with additional information about the nature of the error.
 * The result can hold multiple errors, possibly keyed to fields (for example an error message corresponding to each input form variable)
 *
 * @class JrResult
 */

class JrResult {

	//---------------------------------------------------------------------------
	/**
	 * Creates an instance of JrResult.
	 * @memberof JrResult
	 */
	constructor() {
	}
	//---------------------------------------------------------------------------


	//---------------------------------------------------------------------------
	/**
	 * Helper function to create a new blank JrResult object
	 *
	 * @static
	 * @returns new JrResult object
	 */
	static makeNew() {
		// static helper.
		return new JrResult();
	}


	/**
	 * Helper function to create a new JrResult object and store an error for it
	 *
	 * @static
	 * @returns new JrResult object
	 */
	static makeError(msg) {
		var jrResult = new JrResult();
		jrResult.pushError(msg);
		return jrResult;
	}


	/**
	 * Helper function to create a new JrResult object and store a success message in it
	 *
	 * @static
	 * @returns new JrResult object
	 */
	static makeSuccess(msg) {
		var jrResult = new JrResult();
		jrResult.pushSuccess(msg);
		return jrResult;
	}

	/**
	 * Helper function to create a new JrResult object and store a generic message in it
	 *
	 * @static
	 * @returns new JrResult object
	 */
	static makeMessage(msg) {
		var jrResult = new JrResult();
		jrResult.pushMessage(msg);
		return jrResult;
	}


	/**
	 * make a clone of an existing jr result
	 *
	 * @static
	 * @param {object} source
	 * @returns new JrResult object
	 */
	static makeClone(source) {
		// first we make a new JrResult object, then copy properties
		var target = this.makeNew();
		target.copyFrom(source);
		return target;
	}
	//---------------------------------------------------------------------------



	//---------------------------------------------------------------------------
	/**
	 * clear all fields of the jrResult object
	 */

	clear() {
		this.typestr = undefined;
		this.errorFields = undefined;
		this.items = undefined;
		this.eData = undefined;
	}
	//---------------------------------------------------------------------------


	//---------------------------------------------------------------------------
	// accessors

	/**
	 * Set the type value which can be checked later
	 * @param {*} typestr
	 */
	setType(typestr) {
		this.typestr = typestr;
	}


	/**
	 * Get the type value for the object which can be set
	 */
	getType() { return this.typestr; }
	//---------------------------------------------------------------------------


	//---------------------------------------------------------------------------
	/**
	 * Checks if the jrResult is (contains) an error
	 * @returns true if there are any error items pushed into this jrResult
	 */
	isError() {
		if (this.items &amp;&amp; this.items.error &amp;&amp; this.items.error.length > 0) {
			// explicit error messages in the object
			return true;
		}
		if (this.errorFields &amp;&amp; this.errorFields.length > 0) {
			// there are field specific errors registered
			return true;
		}
		return false;
	}
	//---------------------------------------------------------------------------



	//---------------------------------------------------------------------------
	// fields are key=> value pairs, used for input form errors typically

	/**
	 * Set a field-associated error; marks the result as an error and makes it possible for observer to check which specific field caused it
	 *
	 * @param {string} key
	 * @param {*} value
	 * @returns this
	 */
	setFieldError(key, value) {
		if (this.errorFields === undefined) {
			this.errorFields = {};
		}
		this.errorFields[key] = value;
		return this;
	}


	/**
	 * Gets any error associated with this field key, or defaultVal if none set (defaults to undefined)
	 *
	 * @param {string} key
	 * @param {*} defaultval (if not provided, undefined will be used)
	 * @returns error message associated with key, or defaultVal if none set
	 */
	getFieldError(key, defaultval) {
		if (this.errorFields === undefined || this.errorFields[key] === undefined) {
			return defaultval;
		}
		return this.errorFields[key];
	}


	/**
	 * Generic helper to clear all items in the given section (errors, success, messages)
	 * @private
	 *
	 * @param {*} key
	 * @returns this
	 */
	clearSection(sectionKey) {
		if (this.items === undefined) {
			return this;
		}
		if (this.items[sectionKey] === undefined) {
			return this;
		}
		this.items[sectionKey].clear();

		return this;
	}


	// now we have more generic lists of messages/errors
	/**
	 * Generic helper to push a message into a given section (errors, success, messages)
	 * @private
	 *
	 * @param {string} sectionKey
	 * @param {*} msg - message to add
	 * @param {*} flagOnTop - if true, the new message will be pushed at top of list
	 * @returns this
	 */
	push(sectionKey, msg, flagOnTop) {
		if (this.items === undefined) {
			this.items = {};
		}
		if (this.items[sectionKey] === undefined) {
			this.items[sectionKey] = [msg];
		} else {
			if (flagOnTop) {
				this.items[sectionKey].unshift(msg);
			} else {
				this.items[sectionKey].push(msg);
			}
		}
		return this;
	}


	/**
	 * Set the error associated with a specific key
	 * ##### Notes:
	 *  * this also causes a general (non-feild) error to be added to the object, with the same message
	 *
	 * @param {string} key - the field name to set the error for
	 * @param {string} msg - the error messsage
	 * @returns this
	 */
	pushFieldError(key, msg) {
		// push a generic error, and also add a field error for it
		this.push("error", msg);
		this.setFieldError(key, msg);
		return this;
	}


	/**
	 * Set the error associated with a specific key, AND adds a different error message as a general error
	 *
	 * @param {string} key - the field name to set the error for
	 * @param {string} shortMsg - the error messsage to add to the field
	 * @param {string} longMsg - the error message to add as a generic error
	 * @returns this
	 */
	pushBiFieldError(key, shortMsg, longMsg) {
		// push an error, and also add a field error for it
		this.push("error", longMsg);
		this.setFieldError(key, shortMsg);
		return this;
	}


	/**
	 * Add a generic error to the result
	 *
	 * @param {string} msg
	 * @returns this
	 */
	pushError(msg) {
		this.push("error", msg);
		return this;
	}


	/**
	 * Add a generic error to the result, pushing it to the top of the error list
	 *
	 * @param {string} msg
	 * @returns this
	 */
	pushErrorOnTop(msg) {
		this.push("error", msg, true);
		return this;
	}


	/**
	 * Clear any previous error and then add a generic error to the result
	 *
	 * @param {string} msg
	 * @returns this
	 */
	setError(msg) {
		this.clearSection("error");
		this.push("error", msg);
		return this;
	}


	/**
	 * Add a generic message (not an error) to the result
	 *
	 * @param {string} msg
 	 * @param {boolean} flagOnTop - if true the message will be pushed on top; if unspecified it will not
	 * @returns this
	 */
	pushMessage(msg, flagOnTop) {
		this.push("message", msg, flagOnTop);
		return this;
	}


	/**
	 * Add a success message (not an error) to the result
	 *
	 * @param {string} msg
 	 * @param {boolean} flagOnTop - if true the message will be pushed on top; if unspecified it will not
	 * @returns this
	 */
	pushSuccess(msg, flagOnTop) {
		this.push("success", msg, flagOnTop);
		return this;
	}


	/**
	 * Set generic extra data for the result
	 *
	 * @param {string} key - key to store data in
	 * @param {*} val - data to store
	 * @returns this
	 */
	setExtraData(key, val) {
		if (!this.eData) {
			this.eData = [];
		}
		this.eData[key] = val;
		return this;
	}


	/**
	 * Get generic extra data for the result
	 *
	 * @param {string} key - key to retrieve data for
	 * @param {*} defaultVal - returned if key not set
	 * @returns extra data stored under key, or defaultVal if none
	 */
	getExtraData(key, defaultVal) {
		if (!this.eData || !(key in this.eData)) {
			return defaultVal;
		}
		return this.eData[key];
	}
	//---------------------------------------------------------------------------


	//---------------------------------------------------------------------------
	// merge source into us, adding errors

	/**
	 * This function is used to merge one result into another, combining errors and successes, etc.
	 * It's a rather elaborate function but serves an important purpose when we have multiple results and we care about errors in either.
	 *
	 * @param {object} source - source JrResult
	 * @param {boolean} flagMergeSourceToTop - whether to merge souce object messages above ours when combinging
	 * @returns this
	 */
	mergeIn(source, flagMergeSourceToTop) {
		// this is really an awkward function, i wonder if there isn't a better cleaner way to merge objects and arrays
		// this function is specific to the JrResult class, and not generic
		var key;

		if (!source) {
			return this;
		}

		/*
		if (!(source instanceof JrResult)) {
			throw (new Error("In JrResult mergeIn with improper source result of class " + (typeof source)));
		}
		*/

		// for fields, each keyed item should be a string; on the rare occasion we have an entry in both our field and source field with same key, we can append them.
		if (source.errorFields) {
			if (!this.errorFields) {
				this.errorFields = jrhMisc.shallowCopy(source.errorFields);
			} else {
				for (key in source.errorFields) {
					if (!this.errorFields[key]) {
						this.errorFields[key] = source.errorFields[key];
					} else {
						if (flagMergeSourceToTop) {
							this.errorFields[key] = source.errorFields[key] + " " + this.errorFields[key];
						} else {
							this.errorFields[key] = this.errorFields[key] + " " + source.errorFields[key];
						}
					}
				}
			}
		}

		if (source.items) {
			// but items need to be concatenated
			if (!this.items) {
				this.items = jrhMisc.shallowCopy(source.items);
			} else {
				for (key in source.items) {
					if (!this.items[key]) {
						this.items[key] = jrhMisc.shallowCopy(source.items[key]);
					} else {
						if (flagMergeSourceToTop) {
							this.items[key] = (source.items[key]).concat(this.items[key]);
						} else {
							this.items[key] = (this.items[key]).concat(source.items[key]);
						}
					}
				}
			}
		}

		// if our typestr is blank, use source typestr
		if (!this.typestr) {
			this.typestr = source.typestr;
		} else if (flagMergeSourceToTop &amp;&amp; source.typestr) {
			this.typestr = source.typestr;
		}

		return this;
	}


	/**
	 * Just a shallow copy of the object
	 *
	 * @param {object} source JrResult
	 * @returns this
	 */
	copyFrom(source) {
		// first we make a new JrResult object, then copy properties
		Object.assign(this, source);
		return this;
	}
	//---------------------------------------------------------------------------



	//---------------------------------------------------------------------------
	/**
	 * Check if the passed value is a JrResult
	 *
	 * @static
	 * @param {*} obj
	 * @returns true if obj is an instance of JrResult
	 */
	static isJrResult(obj) {
		return obj instanceof JrResult;
	}


	/**
	 * Simple helper function thats lets us easily check for a case where no errors or messages were added to a JrResult (i.e. it can be completely ignored)
	 *
	 * @static
	 * @param {object} obj
	 * @returns true if the JrResult obj has no data
	 */
	static isBlank(obj) {
		// helper function
		if (!obj) {
			return true;
		}
		if (!obj.items &amp;&amp; !obj.errorFields) {
			return true;
		}
		return false;
	}


	/**
	 * Simple helper function thats makes it easier to ignore a result if there is nothing important in it
	 *
	 * @static
	 * @returns undefined if thhis JrResult is blank
	 */
	undefinedIfBlank() {
		if (JrResult.isBlank(this)) {
			return undefined;
		}
		return this;
	}
	//---------------------------------------------------------------------------


	//---------------------------------------------------------------------------
	// passport helpers

	/**
	 * Return the string associated with a passport error, OR convert the JrResult to an error string if they pass in a JrResult
	 *
	 * @static
	 * @param {object} info - the passport info error (or a jrResult)
	 * @returns error message string
	 */
	static passportOrJrResultErrorAsString(info) {
		if (JrResult.isJrResult(info)) {
			return info.getErrorsAsString();
		}
		if (!info || !info.message) {
			return "unknown authorization error";
		}
		return info.message;
	}
	//---------------------------------------------------------------------------


	//---------------------------------------------------------------------------
	// session helpers for flash message save/load
	/**
	 * Add this JrResult to the (request)session, so it can be remembered for flash error messages (when we show an error on their next/redirected page request)
	 * ##### Notes
	 *  * We add the mergeIn function to combine multiple jrResults into one
	 *
	 * @param {*} req - express request
	 * @param {*} flagAddToTop - add it to the top of the list of such error messages
	 * @returns this
	 */
	addToSession(req, flagAddToTop) {
		// addd to session
		// for consistency we return THIS not the newly merged session info
		assert(req.session, "No session defined, can't add result to it.");

		if (!req.session.jrResult) {
			// just assign it since there is nothing in session -- but should we ASSIGN it instead?
			if (false) {
				req.session.jrResult = this;
			} else {
				req.session.jrResult = JrResult.makeClone(this);
			}
		} else {
			// merge it -- the problem is that the SESSION version is not a true jrresult object so we have to do it backwards
			var sjrResult = req.session.jrResult;
			this.mergeIn(sjrResult, !flagAddToTop);
			// sjrResult.mergeIn(this, flagAddToTop);
			req.session.jrResult = this;
		}
		return this;
	}


	/**
	 * Create a result from the session, or return undefined if there is none, then clear session jrResult
	 * ##### Notes
	 *  * Important: The results will be REMOVED from the session after this is called
	 *
	 * @param {*} req - express request
	 * @returns jrResult from session or undefined if none found
	 */
	static makeAndRemoveFromSession(req) {
		// if not found, just return undefined quickly
		if (!req.session || !req.session.jrResult) {
			return undefined;
		}

		// create new result
		var jrResult = JrResult.makeNew();

		// load and ADD from session, then CLEAR session
		if (req.session.jrResult) {
			this.copyFrom(req.session.jrResult);
			// remove it from session
			delete req.session.jrResult;
		}

		return jrResult;
	}


	/**
	 * Get any existing result from session, merging it with any provided here, and clearing any existing result from session
	 *
	 * @static
	 * @param {*} req - express request
	 * @param {*} res - express result
	 * @param {*} jrResult - the result to render in the session
	 * @param {*} flagSessionAtTop - if true, result errors will be placed at top
	 * @returns the new combined result in the session
	 */
	static getMergeSessionResultAndClear(req, res, jrResult, flagSessionAtTop) {
		// ok we have a jrResult locally that we are about to pass along to view template
		// but if we just passed it in as a local template/view variable, it would OVERWRITE any session data, so we would like to
		// combine them
		// session result, if any (deleting it from session if found, like a flash message)
		var jrResultSession = this.makeAndRemoveFromSession(req);

		if (!jrResult) {
			// empty jrResult, just return session version
			return jrResultSession;
		}

		// combine them and return it
		jrResult.mergeIn(jrResultSession, flagSessionAtTop);
		return jrResult;
	}
	//---------------------------------------------------------------------------



	//---------------------------------------------------------------------------
	/**
	 * Helper function for common issue where we want to store in result whether we have already started rendering result
	 * @todo - remove use of this function and simply store flag in express result
	 *
	 * @param {boolean} val - true or false
	 */
	setDoneRendering(val) {
		this.doneRendering = val;
	}


	/**
	 * Helper function for common issue where we want to store in result whether we have already started rendering result
	 * @todo - remove use of this function and simply store flag in express result
	 * @returns true if this flag has been set
	 */
	getDoneRendering() {
		return this.doneRendering;
	}
	//---------------------------------------------------------------------------



	//---------------------------------------------------------------------------
	/**
	 * Experimental express middleware function that automatically grabs any pending jrResult error from session and makes it available in the locals variable of a view for display
	 * ##### Notes
	 * express middleware helper
	 * the idea here is we want to take any session jrResult found in session, and put it automatically in any render call res
	 * all this does is save us from having to make every render look like this:
	 *    	res.render("viewpage", {
	 *         jrResult: JrResult.restoreFromSession(req);
	 *      });
	 * see https://stackoverflow.com/questions/9285880/node-js-express-js-how-to-override-intercept-res-render-function
	 *
	 * ATTN: 5/27/19 -- although this worked flawlessly, we have decided to force the manaul use of this into all render calls, to have better control over it
	 * but the proper call now is a bit more involved, it should be like this:
	 *	res.render("urlpath", {
	 *      jrResult: JrResult.getMergeSessionResultAndClear(req, res, jrResult),
	 *      // or if we have no result of our own: jrResult: JrResult.getMergeSessionResultAndClear(req, res)
	 *      }
	 * this old code does NOT do a merge combine of session data with manual jrresult, so can no longer be used
	 *
	 *
	 * @static
	 * @param {*} options
	 */
	static _unusedCodeExpressMiddlewareInjectSessionResult(options) {
		options = options || {};
		// var safe = (options.unsafe === undefined) ? true : !options.unsafe;
		return (req, res, next) => {
			// grab reference of render
			var jRrender = res.render;
			// override logic
			res.render = (view, roptions, fn) => {
				// transfer any session jrResult into RESPONSE view available variable
				res.locals.jrResult = JrResult.makeAndRemoveFromSession(req);
				// continue with original render
				jRrender.call(this, view, roptions, fn);
			};
			next();
		};
	}
	//---------------------------------------------------------------------------



	//---------------------------------------------------------------------------
	/**
	 * Return a string containing all errors in the result
	 *
	 * @returns error string
	 */
	getErrorsAsString() {
		if (!this.items || !this.items.error || this.items.error.length &lt;= 0) {
			return "";
		}
		var str = this.items.error.join(";");
		return str;
	}
	//---------------------------------------------------------------------------


}





//---------------------------------------------------------------------------
// export the class
module.exports = JrResult;
//---------------------------------------------------------------------------
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Thu Nov 14 2019 07:39:49 GMT-0600 (Central Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
