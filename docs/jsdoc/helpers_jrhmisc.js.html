<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>helpers/jrhmisc.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-controllers_aclaid-AclAid.html">AclAid</a></li></ul><h3>Modules</h3><ul><li><a href="module-controllers_aclaid.html">controllers/aclaid</a></li><li><a href="module-helpers_jrcrypto.html">helpers/jrcrypto</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrcrypto.html#~createHashedObjectFromString">createHashedObjectFromString</a></li><li data-type='method'><a href="module-helpers_jrcrypto.html#~generateRandomSalt">generateRandomSalt</a></li><li data-type='method'><a href="module-helpers_jrcrypto.html#~genRandomStringHex">genRandomStringHex</a></li><li data-type='method'><a href="module-helpers_jrcrypto.html#~genRandomStringHumanEasier">genRandomStringHumanEasier</a></li><li data-type='method'><a href="module-helpers_jrcrypto.html#~genRandomStringHumanEasy">genRandomStringHumanEasy</a></li><li data-type='method'><a href="module-helpers_jrcrypto.html#~hashPlaintextPasswordToObj">hashPlaintextPasswordToObj</a></li><li data-type='method'><a href="module-helpers_jrcrypto.html#~hashPlaintextStringInsecureButSearchable">hashPlaintextStringInsecureButSearchable</a></li><li data-type='method'><a href="module-helpers_jrcrypto.html#~testPlaintextPassword">testPlaintextPassword</a></li></ul></li><li><a href="module-helpers_jrhandlebars.html">helpers/jrhandlebars</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrhandlebars.html#~loadPartialFiles">loadPartialFiles</a></li><li data-type='method'><a href="module-helpers_jrhandlebars.html#~setupJrHandlebarHelpers">setupJrHandlebarHelpers</a></li></ul></li><li><a href="module-helpers_jrhelpers.html">helpers/jrhelpers</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrhelpers.html#~asyncAwaitForEachFunctionCall">asyncAwaitForEachFunctionCall</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~createObjectFromJsonParse">createObjectFromJsonParse</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~DateNowPlusMinutes">DateNowPlusMinutes</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~deepIterationCopy">deepIterationCopy</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~firstCoercedTrueValue">firstCoercedTrueValue</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~getNiceNowString">getNiceNowString</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~getNonFalseValueOrDefault">getNonFalseValueOrDefault</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~getPreciseNowString">getPreciseNowString</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~getServerIpAddress">getServerIpAddress</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~isInAnyArray">isInAnyArray</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~isObjectEmpty">isObjectEmpty</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~isPromise">isPromise</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~isSimpleObject">isSimpleObject</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~makeSafeForFormInput">makeSafeForFormInput</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~mergeArraysDedupe">mergeArraysDedupe</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~mergeArraysKeepDupes">mergeArraysKeepDupes</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~regexEscapeStr">regexEscapeStr</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~shallowCopy">shallowCopy</a></li><li data-type='method'><a href="module-helpers_jrhelpers.html#~stringArrayToNiceString">stringArrayToNiceString</a></li></ul></li><li><a href="module-helpers_jrhelpersexpress.html">helpers/jrhelpersexpress</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~asyncPasswordAuthenticate">asyncPasswordAuthenticate</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~asyncPasswordReqLogin">asyncPasswordReqLogin</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~calcExpressMiddleWare">calcExpressMiddleWare</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~calcExpressRoutePathData">calcExpressRoutePathData</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~calcExpressRoutePathDataRouteArray">calcExpressRoutePathDataRouteArray</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~calcExpressRoutePathDataSplit">calcExpressRoutePathDataSplit</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~forgetSessionVar">forgetSessionVar</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~normalizePort">normalizePort</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~reqPrefixedValueArray">reqPrefixedValueArray</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~reqVal">reqVal</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~reqValAsInt">reqValAsInt</a></li><li data-type='method'><a href="module-helpers_jrhelpersexpress.html#~reqValFromList">reqValFromList</a></li></ul></li><li><a href="module-helpers_jrhelpersmdb.html">helpers/jrhelpersmdb</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrhelpersmdb.html#~calcDatabaseResourceUse">calcDatabaseResourceUse</a></li><li data-type='method'><a href="module-helpers_jrhelpersmdb.html#~calcDatabaseStructure">calcDatabaseStructure</a></li><li data-type='method'><a href="module-helpers_jrhelpersmdb.html#~isValidMongooseObjectId">isValidMongooseObjectId</a></li><li data-type='method'><a href="module-helpers_jrhelpersmdb.html#~mongoIdEqual">mongoIdEqual</a></li></ul></li><li><a href="module-helpers_jrhgrid.html">helpers/jrhgrid</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrhgrid.html#~calcHeaderKeysNicely">calcHeaderKeysNicely</a></li><li data-type='method'><a href="module-helpers_jrhgrid.html#~jrGridList">jrGridList</a></li><li data-type='method'><a href="module-helpers_jrhgrid.html#~jrGridListPager">jrGridListPager</a></li><li data-type='method'><a href="module-helpers_jrhgrid.html#~jrGridListPagerItem">jrGridListPagerItem</a></li><li data-type='method'><a href="module-helpers_jrhgrid.html#~jrGridListPagerItemPerPage">jrGridListPagerItemPerPage</a></li><li data-type='method'><a href="module-helpers_jrhgrid.html#~jrGridListTable">jrGridListTable</a></li><li data-type='method'><a href="module-helpers_jrhgrid.html#~jrGridListTableData">jrGridListTableData</a></li><li data-type='method'><a href="module-helpers_jrhgrid.html#~jrGridListTableHeader">jrGridListTableHeader</a></li><li data-type='method'><a href="module-helpers_jrhgrid.html#~jrGridListTableHeaderSortDir">jrGridListTableHeaderSortDir</a></li></ul></li><li><a href="module-helpers_jrhmisc.html">helpers/jrhmisc</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrhmisc.html#~jrBootstrapCollapseBox">jrBootstrapCollapseBox</a></li><li data-type='method'><a href="module-helpers_jrhmisc.html#~jrHtmlFormInputPassword">jrHtmlFormInputPassword</a></li><li data-type='method'><a href="module-helpers_jrhmisc.html#~jrHtmlFormOptionList">jrHtmlFormOptionList</a></li><li data-type='method'><a href="module-helpers_jrhmisc.html#~jrHtmlFormOptionListSelect">jrHtmlFormOptionListSelect</a></li><li data-type='method'><a href="module-helpers_jrhmisc.html#~jrHtmlNiceOptionFromList">jrHtmlNiceOptionFromList</a></li><li data-type='method'><a href="module-helpers_jrhmisc.html#~jrHtmlStrigifyObject">jrHtmlStrigifyObject</a></li><li data-type='method'><a href="module-helpers_jrhmisc.html#~jrPluralize">jrPluralize</a></li><li data-type='method'><a href="module-helpers_jrhmisc.html#~jrPluralizeCount">jrPluralizeCount</a></li></ul></li><li><a href="module-helpers_jrvalidators.html">helpers/jrvalidators</a><ul class='methods'><li data-type='method'><a href="module-helpers_jrvalidators.html#~validateInteger">validateInteger</a></li><li data-type='method'><a href="module-helpers_jrvalidators.html#~validateIntegerRange">validateIntegerRange</a></li><li data-type='method'><a href="module-helpers_jrvalidators.html#~validateRealName">validateRealName</a></li><li data-type='method'><a href="module-helpers_jrvalidators.html#~validateString">validateString</a></li><li data-type='method'><a href="module-helpers_jrvalidators.html#~validateTrueFalse">validateTrueFalse</a></li></ul></li><li><a href="module-routes_api.html">routes/api</a><ul class='methods'><li data-type='method'><a href="module-routes_api.html#~makeSecureTokenAccess">makeSecureTokenAccess</a></li><li data-type='method'><a href="module-routes_api.html#~makeSecureTokenAccessFromRefreshToken">makeSecureTokenAccessFromRefreshToken</a></li><li data-type='method'><a href="module-routes_api.html#~makeSecureTokenRefresh">makeSecureTokenRefresh</a></li><li data-type='method'><a href="module-routes_api.html#~routerAllTokentest">routerAllTokentest</a></li><li data-type='method'><a href="module-routes_api.html#~routerGetIndex">routerGetIndex</a></li><li data-type='method'><a href="module-routes_api.html#~routerGetRefreshaccess">routerGetRefreshaccess</a></li><li data-type='method'><a href="module-routes_api.html#~routerGetReqrefresh">routerGetReqrefresh</a></li><li data-type='method'><a href="module-routes_api.html#~routerGetWildcard">routerGetWildcard</a></li><li data-type='method'><a href="module-routes_api.html#~routerPostReqrefresh">routerPostReqrefresh</a></li><li data-type='method'><a href="module-routes_api.html#~setupRouter">setupRouter</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">helpers/jrhmisc.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module helpers/jrhmisc
 * @author jesse reichler &lt;mouser@donationcoder.com>
 * @copyright 5/24/19

 * @description
 * Collection of my general helper functions for html/views
*/

"use strict";




/**
 * Pluralize a string based on a number (presumably the number of items being referred to)
 * @example "You have eaten " + jrPluralizeCount(4, "apples", "apples")
 * So it used the singular if the count is 1, otherwise the plural
 *
 * @param {int} number
 * @param {string} singular
 * @param {string} plural
 * @returns string with number specified as signular or plural, and number mentioned specifically
 */
function jrPluralizeCount(number, singular, plural) {
	if (number === undefined) {
		number = 0;
	} else if (Array.isArray(number)) {
		number = number.length;
	}
	//
	var numberStr = number.toString();
	if (number === 1) {
		return numberStr + " " + singular;
	}
	return (typeof plural === "string" ? numberStr + " " + plural : numberStr + " " + singular + "s");
}

/**
 * Pluralize a string based on a number (presumably the number of items being referred to)
 * @example "You have eaten " + jrPluralize(4, "one apple", "some apples")
 * @example "Should we discard the " + jrPluralize(4, "apple")
 * So it used the singular if the count is 1, otherwise the plural form; if no plural form is specified, use singular and add "s"
 *
 * @param {int} number
 * @param {string} singular
 * @param {string} plural
 * @returns string with number specified as signular or plural
 */
function jrPluralize(number, singular, plural) {
	if (number === undefined) {
		number = 0;
	} else if (Array.isArray(number)) {
		number = number.length;
	}
	if (number === 1) {
		return singular;
	}
	return (typeof plural === "string" ? plural : singular + "s");
}
//---------------------------------------------------------------------------




/**
 * Create an html input select (drop down) list.
 *
 * @param {string} name of the select input
 * @param {array} pairlist - list of id -> description pairs
 * @param {*} selectedid - id of currently select id (if any)
 * @returns html for inclusion in form
 */
function jrHtmlFormOptionListSelect(selectName, pairlist, selectedid) {
	var appHtmlList = jrHtmlFormOptionList(pairlist, selectedid);
	var rethtml = `
		&lt;select name="${selectName}">
			${appHtmlList}
		&lt;/select>
		`;
	return rethtml;
}

/**
 *
 * Create an html string containing &lt;option value="val">description&lt;/option> values
 *
 * @param {array} pairlist - list of id -> description pairs
 * @param {*} selectedid - id of currently select id (if any)
 * @returns html for inclusion in form (inside a select form object usually)
 */
function jrHtmlFormOptionList(pairlist, selectedid) {
	var rethtml = "";
	var foundId = false;
	// cast id to a string
	selectedid = (selectedid === null || selectedid === undefined) ? "" : selectedid.toString();
	// now find it in list
	if (pairlist) {
		var seltext;
		for (var key in pairlist) {
			if (key === selectedid) {
				seltext = " selected";
				foundId = true;
			} else {
				seltext = "";
			}
			rethtml += "&lt;option value=\"" + key + "\"" + seltext + ">" + pairlist[key] + "&lt;/option>\n";
		}
	}
	if (selectedid &amp;&amp; !foundId) {
		// since we couldn't find an item for selected one, and an id was specifiedi, we add a new option at top and select it
		rethtml = "&lt;option value=\"" + selectedid + "\" selected> UNKNOWN VALUE (#" + selectedid + ")&lt;/option>\n" + rethtml;
	}
	return rethtml;
}


/**
 * Given a pairlist of form id=>optionlabel, return the optionlabel corresponding to specified id
 *
 * @param {array} pairlist - list of id -> description pairs
 * @param {*} selectedid - id of currently select id (if any)
 * @param {*} defaultVal - value to return if not found in list
 * @returns the description/label associated with the id, or defaultVal if not found
 */
function jrHtmlNiceOptionFromList(pairlist, selectedid, defaultVal) {
	// blank, nothing we can do
	if (selectedid === null || selectedid === undefined || selectedid === "") {
		return defaultVal;
	}
	var label = pairlist[selectedid];
	if (label === undefined) {
		return defaultVal;
	}

	return label;
}
//---------------------------------------------------------------------------





/**
 * Helper funciton to generate some html that shows a bootstrap spoiler box with some debug information
 *
 * @param {string} title
 * @param {string} body
 * @param {string} footer
 * @returns html string
 */
function jrBootstrapCollapseBox(title, body, footer) {

	if (!(body instanceof String)) {
		body = "&lt;pre>" + JSON.stringify(body, null, "  ") + "&lt;/pre>";
	}

	var rethtml = `
		&lt;div class="card" style="padding: 5px; margin: 5px;">
				&lt;div class="card-heading">
					&lt;h4 class="card-title">
					&lt;a data-toggle="collapse" href="#collapse1">&amp;gt; ${title}&lt;/a>
					&lt;/h4>
				&lt;/div>
				&lt;div id="collapse1" class="card-collapse collapse">
					&lt;div class="card-body">${body}&lt;/div>
					&lt;div class="card-footer">${footer}&lt;/div>
				&lt;/div>
		&lt;/div>
		`;

	return rethtml;
}
//---------------------------------------------------------------------------




//---------------------------------------------------------------------------
/**
 * Simple wrapper for JSON.stringify that formats output for html using &lt;pre> tags
 *
 * @param {*} obj
 * @returns html string
 */
function jrHtmlStrigifyObject(obj) {
	var rethtml = "&lt;pre>" + JSON.stringify(obj, null, "  ") + "&lt;/pre>";
	return rethtml;
}
//---------------------------------------------------------------------------




/**
 * Create html text for a form input password, with a hint saying whether there is an existing value in the database,
 * and a hint saying whether leaving the value blank will preserve existing value,
 * and a hint showing how to clear the database value by using a "-" character (if this is an optional password field)
 *
 * @param {string} fieldName
 * @param {*} obj
 * @param {boolean} flagRequired
 * @param {boolean} flagExistingIsNonBlank
 * @returns html string
 */
function jrHtmlFormInputPassword(fieldName, obj, flagRequired, flagExistingIsNonBlank) {
	var rethtml, val;
	if (obj &amp;&amp; obj[fieldName]) {
		val = obj[fieldName];
	} else {
		val = "";
	}
	rethtml = `&lt;input name="${fieldName}" type="password" value="${val}">`;
	if (flagExistingIsNonBlank) {
		rethtml += " (existing password in db is encrypted and non-blank; leave this field empty to preserve the existing password";
		if (!flagRequired) {
			rethtml += "; or specify '-' to delete existing password and leave it blank";
		}
		rethtml += ")";
	}
	return rethtml;
}
//---------------------------------------------------------------------------








module.exports = {
	jrPluralizeCount,
	jrPluralize,
	jrHtmlFormOptionListSelect,
	jrHtmlFormOptionList,
	jrHtmlNiceOptionFromList,
	jrBootstrapCollapseBox,
	jrHtmlStrigifyObject,
	jrHtmlFormInputPassword,
};

</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Wed Nov 13 2019 06:59:20 GMT-0600 (Central Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
